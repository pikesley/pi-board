---
---
<h1>Approximate π by throwing darts</h1>
<div class='well'>
  <div class='row'>
    <canvas class='col-md-6' id='square' width='{{ site.data.attributes.side }}' height='{{ site.data.attributes.side }}'></canvas>
    <div class='col-md-6'>
      <div class='row'>
        <dl class='col-md-10 dl-horizontal'>
          <dt>Throws</dt><dd id='throws'></dd>
          <dt>Hits</dt><dd id='hits'></dd>
          <dt>π<dt><dd id='pi-value'></dd>
        </dl>
        <div class='col-md-2'>
          <button class='button btn btn-info' onclick='darts()'>Start</button>
        </div>
      </div>
      <div class='row'>
        {% include explanation.html %}
      </div>
    </div>
  </div>
</div>

<script>

var c = document.getElementById('square');
var ctx = c.getContext('2d');
ctx.fillStyle = '{{ site.data.attributes.colours.canvas }}';
ctx.fillRect(0, 0, {{ site.data.attributes.side }}, {{ site.data.attributes.side }});

function darts() {
  var throws = 0
  var hits = 0
  while(throws <= 100000) {
    var hit = false
    x = negify(Math.random())
    y = negify(Math.random())
    if(is_hit(x, y)) {
      hit = true
      hits += 1
    }

    var colour = '{{ site.data.attributes.colours.throw }}'
    if(hit == true) {
      colour = '{{ site.data.attributes.colours.hit }}'
    }

    var plot_string = "plot(" + x + "," + y + ",'" + colour + "')"
    var throws_string = "$('#throws').text('" + throws + "')"
    var hits_string = "$('#hits').text('" + hits + "')"
    var pi_string = "$('#pi-value').text('" + pi + "')"

    var pi = (4.0 * (hits / throws))
    var loopTimer = setTimeout(
      plot_string + " ; " + throws_string + " ; " + hits_string + " ; " + pi_string,
      100
    )
    throws += 1
  }
}
function is_hit(x, y) {
  return ((Math.sqrt((x * x) + (y * y))) < 1)
}

function plot(x, y, colour) {
  ctx.fillStyle = colour
  var scale = ({{ site.data.attributes.side }} - {{ site.data.attributes.blob }}) / 2
  ctx.fillRect((x * scale) + scale, (y * scale) + scale, {{ site.data.attributes.blob }}, {{ site.data.attributes.blob }});
}

function negify(value) {
  if(Math.random() > 0.5) {
    return -value
  } else {
    return value
  }
}

</script>
